name: Schedule Build

on:
  schedule:
    # æ¯å¤©å‡Œæ™¨ 2 ç‚¹æ‰§è¡Œ
    - cron: "0 2 * * *"
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  scheduled-build:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¦ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: ðŸ”§ è®¾ç½® Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: ðŸ“¥ å®‰è£…ä¾èµ–
        run: |
          npm install -g pnpm
          pnpm install

      - name: ðŸ” æ£€æŸ¥è¿‡æœŸä¾èµ–
        run: pnpm outdated || true

      - name: ðŸ—ï¸ æž„å»ºæµ‹è¯•
        run: pnpm run build:weapp

      - name: ðŸ“Š ç”ŸæˆæŠ¥å‘Š
        if: failure()
        run: |
          echo "âš ï¸ å®šæ—¶æž„å»ºå¤±è´¥ï¼Œè¯·æ£€æŸ¥ä¾èµ–å…¼å®¹æ€§" >> $GITHUB_STEP_SUMMARY
